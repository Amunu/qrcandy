<% include _partial/header.ejs %>
  <div style="padding-top: 19px" class="col-lg-9 col-lg-offset-1 col-md-10 col-md-offset-1">
    <div class="jumbotron">
      <h2>个人信息</h2>
      <div class="row" style="margin-top:30px;">
        <div class="col-md-3 col-md-offset-1">
          <div class="row">
            <div class="col-md-12">
              <div class="img-responsive" style="border-radius:10px;"></div>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <ul class="list-unstyled">
            <li>
              <h3><%= username %></h3>
            </li>
            <li>邮箱：<%= user.email %></li>
            <li>注册时间 : <%= user.reg_time %></li>


          </ul>
        </div>
        <div class="col-md-4">
          <ul class="list-unstyled" style="margin-top:10px">
            <li>
              <%= username %> 有<span style="font-size:34px;" class="info"><%= data.data.length %></span>个二维码
            </li>
            <li><span style="font-size:34px;" class="info"><%= data.data.length %></span>个活码</li>
          </ul>
        </div>
    </div>
    </div>

    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>类型</th>
          <th>创建时间</th>
          <th>内容</th>
          <th>操作</th>
        </tr>
      </thead>
      <tbody>

      </tbody>
    </table>
    <div style=" margin-left: auto; margin-right: auto;">
      <nav>
        <ul class="pagination">
        </ul>
      </nav>
    </div>
  </div>

  <style type="text/css">
    .list-unstyled {
      font-size: 18px;
    }
    .info-number {
      font-family: Constantia,Georgia;
    }
  </style>

  <script>
    $(function() {
      var str = "<%= hash %>";
      var url = "<img src='http://www.gravatar.com/avatar/" + str + "?s=150' />";
      $(".img-responsive").append(url);
      if(<%= data.pages %>) {
        var page = 1;
        var pages = <%= data.pages %>;
        $(".pagination").append("<li><a href='#'>&laquo;</a></li>");
        while(page <= pages) {
          $(".pagination").append("<li><a href='/user/" + page + "'>" + page + "</a></li>");
          page ++;
        }

        $("[href$='/user/<%= _page %>']").parent().addClass('active');

        $(".pagination").append("<li><a href='#'>&raquo;</a></li>");

      }

      if(<%= data.data.length %>) {
        var data = <%- JSON.stringify(data.data) %> ;
        console.log(<%= _page %>);
        data.forEach(function(qrcode) {
          if(qrcode.info.length > 30) qrcode.info = qrcode.info.substr(0,27) + '...';
          $("tbody").append(
            "<tr><td>" + qrcode.type +
            "</td><td>" + qrcode.created_at +
            "</td><td>" + qrcode.info +
            "</td><td><a href = '#' activeid = '" + qrcode.qrcode_id + "'><span class='glyphicon glyphicon-qrcode'></span> 二维码  </a>" +
            "<a href = '#' activeid = '" + qrcode.qrcode_id + "' style='padding-left: 10px'><span class='glyphicon glyphicon-pencil'></span>编辑</a>" +
            "<a href = '#' activeid = '" + qrcode.qrcode_id + "' style='padding-left: 10px'><span class='glyphicon glyphicon-trash'></span> 删除  </a></td></tr>");
        })
      }

      $(".user").addClass('active');

    });
  </script>
<% include _partial/footer.ejs %>
